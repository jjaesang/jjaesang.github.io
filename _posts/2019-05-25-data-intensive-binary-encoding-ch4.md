---
layout: post
title:  "[Data-Intensive] Ch4. 부호화와 발전"
date: 2019-05-25 15:15:12
categories: Data-Intensive-Application 
author : Jaesang Lim˚
tag: Data-Intensive-Application 
cover: "/assets/instacode.png"
---

## 저장소와 검색
'데이터 중심 애플리케이션 설계'를 읽고 정리하고자함

---

## 데이터 부호화 형식
- 프로그램은 보통 최소한 두가지 형태로 표현된 데이터를 사용해 동작함
- 메모리에 object, struct, list, array, hash table, tree 등으로 데이터를 유지함
- 이 데이터 구조는 CPU에서 효율적으로 접근하고 조작할 수 있게 pointer를 통해 최적화함

- 데이터를 파일에 쓰거나, 네트워크를 통해 전송하려면 **스스로를 포함한 일련의 바이트열의 형태로 인코딩**되어야함
- 포인터는 다른 프로세스가 이해할 수 없으므로, 이 일련의 바이트열은 보통 메모리에서 사용하는 데이터 구조와는 다름

- 두 가지 표현 사이에 일종의 변환관계가 필요함
> - 부호화(직렬화/마샬링)
> > - 인메모리 표현에서 바이트열로의 전환
> - 복화화(파싱/역직렬화/언마샬링)
> > - 바이트열을 인메모리 표현으로 전환

- 데이터 전환을 위한 다양한 라이브러리와 부호화형식 이 있음

- 많은 프로그래밍 언어는 인메모리 객체를 바이트열로 부호화하는 기능을 내장함
> - 자바 java.io.Serializable
> - 루비 Marshal
> - 파이썬 pickle
> - 서드파티 kryo 등등

- 이와 같이 프로그래밍 언어에 내장된 부호화 라이브러리는 최소한의 추카 코드로 인메모리 객체를 저장하고 복원할 수 있어 편하지만, 문제도 있음

1. 부호화는 특정 프로그래밍 언어와 묶여, 다른 언어에서 데이터를 읽기가 어려움
2. 동일한 객체 유형의 데이터를 복원하려면, 복호화 과정이 임의의 클래스를 인스턴스화할 수 있어야 함
> - 보안문제 발생 가능
> - 공격자가 임의의 바이트열을 복호화할 수 있는 애플리케이션을 얻느다면 임의의 클래스를 인스턴스화해 원격으로 코드를 실행시킬 수 있음
3. 데이터 버전 관리 측면의 어려움
> - 데이터를 쉽게 빠르게 부호화하기 위해 상위, 하위 호환성의 불편할 수 있음
4. 효율성
> - 부호화나 복호화에 소요되는 CPU시간과 부호화된 구조체 크기 등이 문제가 될 수 있음
> - 자바의 내장 직렬화는 성능이 좋지 않고 비대해지는 문제가 있음k

### JSON과 XML, 이진 변형

- JSON은 수,number의 부호화에 있어 애매함이 있음
> - 문자열과 수를 구분하지만 정수와 부동소수점 수를 구별하지 않고 정밀도를 지정하지 낳음
> - 큰 수를 다룰 때 문제가 될 수 있음

- JSON과 XML은 유니코드 문자열, 즉 사람이 읽을 수 있는 텍스트를 잘 지원함
> - 그러나 이진 문자열, binary 문자 부호화가 없는 바이트 열을 지원하지 않음
> - 이진 데이터를 Base64를 사용해 텍스트로 부호화해서 사용할 수 있음

- CSV는 스키마가 없어 로우와 컬럼의 의미를 정의하는 작업은 애플리케이션에서 해야함

### 이진 부호화

- 테라바이트 정도의 데이터가 되면 데이터 타입의 선택이 큰 영향을 줌
- JSON 가능한 이진 부호화 (binary encoding)
> - MessagaPack, BSON, BJSON, UBJSON, BISON, Smile 등
- XML 가능한 이진 부호화
> - WBXML. Fast Infoset

- 이진 부호화는 작은 공간의 절약이 사람의 가독성을 해칠만큼 가치가 있는지는 확실하지 않음

### 스리프트(Apache Thrift)와 프로토콜 버퍼(Protocol Buffer)

- 이진 부호화 라이브러리 
- 프로토콜 버퍼는 구글, 스리프트는 페이스북에서 개발 
- 두 개 모두 부호화할 데이터를 위한 스키마가 필요
